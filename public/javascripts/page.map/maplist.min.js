var mapName = 'dashboard-map'
var textBusinessName = $('#txt-business-name')
var buttonBusinessName = $('#btn-business-add')

function initData(){
  $.ajax({
    url: '/api/maps/maplist',
    dataType: 'json',
    type: 'GET',
    success: function(data){
      console.log(data);
      for (var i in data){
        var insideHTML =
        `<li>
          <a href="/map/detail/${data[i]._id}">
            <div class="wrapper">
              <h3 class="title"><strong>${data[i].businessName}</strong></h3>
            </div>
          </a>
        </li>`
        $('#content-list').append(insideHTML)
      }
    }.bind(this),
    error: function(xhr, status, err){}.bind(this)
  })
}

function initAction(){
  buttonBusinessName.on('click', function(e){
    e.preventDefault()
    // AJAX ADD MAP GOES HERE - START
    $.ajax({
      url: '/map/addMap',
      dataType: 'json',
      type: 'POST',
      data: {
        userID: $('#hdn-userid').val().trim(),
        businessName: textBusinessName.val().trim()
      },
      success: function(data){
        window.location.replace(`/map/detail/${data.mapID}`)
      }.bind(this),
      error: function(xhr, status, err){}.bind(this)
    })

    //alert('HAHAH')
    // AJAX ADD MAP GOES HERE - END
  })
}

function initDashboard(){
  initData()
  initAction()
}

$(function(){
  verify(initDashboard(), false, 'p.signin.html')
})
